<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Node Arrangement Diagram &#8212; DistQat  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Training Flow Diagram" href="TRAINING_FLOW.html" />
    <link rel="prev" title="Architecture Diagram" href="ARCHITECTURE.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="node-arrangement-diagram">
<h1>Node Arrangement Diagram<a class="headerlink" href="#node-arrangement-diagram" title="Link to this heading">¶</a></h1>
<div class="mermaid">
            graph TB
    subgraph &quot;Machine 1 (Coordinator)&quot;
        M1[Monitor&lt;br/&gt;:50000&lt;br/&gt;DHT Entry Point]
        C1[Client&lt;br/&gt;:51000&lt;br/&gt;Trainer Manager]
    end
    
    subgraph &quot;Machine 2 (Worker A)&quot;
        S1A[Server&lt;br/&gt;:50500&lt;br/&gt;front.0.0.0]
        S1B[Server&lt;br/&gt;:50501&lt;br/&gt;back.0.0.0]
    end
    
    subgraph &quot;Machine 3 (Worker B)&quot;
        S2A[Server&lt;br/&gt;:50500&lt;br/&gt;front.0.1.0]
        S2B[Server&lt;br/&gt;:50501&lt;br/&gt;back.0.1.0]
    end
    
    subgraph &quot;Machine 4 (Worker C)&quot;
        S3A[Server&lt;br/&gt;:50500&lt;br/&gt;front.0.2.0]
        S3B[Server&lt;br/&gt;:50501&lt;br/&gt;back.0.2.0]
    end
    
    subgraph &quot;Dynamic Trainers (spawned by Client)&quot;
        T1[Trainer 1&lt;br/&gt;Pipeline: 0→1]
        T2[Trainer 2&lt;br/&gt;Pipeline: 0→1]
        T3[Trainer 3&lt;br/&gt;Pipeline: 0→1]
    end
    
    M1 -.DHT.-&gt; C1
    M1 -.DHT.-&gt; S1A
    M1 -.DHT.-&gt; S1B
    M1 -.DHT.-&gt; S2A
    M1 -.DHT.-&gt; S2B
    M1 -.DHT.-&gt; S3A
    M1 -.DHT.-&gt; S3B
    
    C1 --&gt;|spawns| T1
    C1 --&gt;|spawns| T2
    C1 --&gt;|spawns| T3
    
    T1 --&gt;|uses| S1A
    T1 --&gt;|uses| S1B
    T2 --&gt;|uses| S2A
    T2 --&gt;|uses| S2B
    T3 --&gt;|uses| S3A
    T3 --&gt;|uses| S3B
        </div><section id="port-assignment-pattern">
<h2>Port Assignment Pattern<a class="headerlink" href="#port-assignment-pattern" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Monitor:  50000
Client:   51000
Servers:  50500 + &lt;0 to num_servers&gt;

Examples:
- front.0.0.0 → 50500 (stage 0, expert 0)
- back.0.0.0  → 50501 (stage 1, expert 0)
- front.0.1.0 → 50502 (stage 0, expert 1)
- back.0.1.0  → 50503 (stage 1, expert 1)
# if they are started in the same process
</pre></div>
</div>
</section>
<section id="expert-uid-naming-convention">
<h2>Expert UID Naming Convention<a class="headerlink" href="#expert-uid-naming-convention" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">stage_name</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">version</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">expert_index</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">subversion</span><span class="p">}</span>

<span class="n">Examples</span><span class="p">:</span>
<span class="o">-</span> <span class="n">front</span><span class="mf">.0.0.0</span>  <span class="p">(</span><span class="n">front</span> <span class="n">stage</span><span class="p">,</span> <span class="n">replica</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">-</span> <span class="n">front</span><span class="mf">.0.1.0</span>  <span class="p">(</span><span class="n">front</span> <span class="n">stage</span><span class="p">,</span> <span class="n">replica</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">-</span> <span class="n">back</span><span class="mf">.0.0.0</span>   <span class="p">(</span><span class="n">back</span> <span class="n">stage</span><span class="p">,</span> <span class="n">replica</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">-</span> <span class="n">back</span><span class="mf">.0.1.0</span>   <span class="p">(</span><span class="n">back</span> <span class="n">stage</span><span class="p">,</span> <span class="n">replica</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">-</span> <span class="n">head</span><span class="mf">.0.0.0</span>   <span class="p">(</span><span class="n">head</span> <span class="n">stage</span> <span class="k">for</span> <span class="mi">3</span><span class="o">-</span><span class="n">stage</span> <span class="n">models</span><span class="p">)</span>
<span class="o">-</span> <span class="n">body</span><span class="mf">.0.0.0</span>   <span class="p">(</span><span class="n">body</span> <span class="n">stage</span> <span class="k">for</span> <span class="mi">3</span><span class="o">-</span><span class="n">stage</span> <span class="n">models</span><span class="p">)</span>
<span class="o">-</span> <span class="n">tail</span><span class="mf">.0.0.0</span>   <span class="p">(</span><span class="n">tail</span> <span class="n">stage</span> <span class="k">for</span> <span class="mi">3</span><span class="o">-</span><span class="n">stage</span> <span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multi-machine-deployment-example">
<h2>Multi-Machine Deployment Example:<a class="headerlink" href="#multi-machine-deployment-example" title="Link to this heading">¶</a></h2>
<section id="scenario-5-machines-2-stage-pipeline">
<h3>Scenario: 5 Machines, 2-Stage Pipeline<a class="headerlink" href="#scenario-5-machines-2-stage-pipeline" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────┐
│ Machine 1: 192.168.1.10 (Coordinator)                   │
│ ├─ Monitor (port 50000) - DHT entry point               │
│ └─ Client (port 51000) - spawns trainers                │
└─────────────────────────────────────────────────────────┘
                    │
        ┌───────────┴───────────┬──────────┬───────────────┐
        │                       │          │               │
┌───────▼─────────┐   ┌─────────▼─────┐  ┌─▼──────────┐  ┌─▼──────────┐
│ Machine 2:      │   │ Machine 3:    │  │ Machine 4: │  │ Machine 5: │
│ 192.168.1.11    │   │ 192.168.1.12  │  │ 10.0.0.5   │  │ 10.0.0.6   │
│ (Local Worker)  │   │ (Local Worker)│  │ (Remote)   │  │ (Remote)   │
├─────────────────┤   ├───────────────┤  ├────────────┤  ├────────────┤
│ front.0.0.0     │   │ front.0.1.0   │  │ back.0.0.0 │  │ back.0.1.0 │
│ port 50500      │   │ port 50500    │  │ port 50500 │  │ port 50500 │
│ GPU: cuda:0     │   │ GPU: cuda:0   │  │ GPU: cuda:0│  │ GPU: cuda:0│
└─────────────────┘   └───────────────┘  └────────────┘  └────────────┘
</pre></div>
</div>
</section>
<section id="load-balancing-across-replicas">
<h3>Load Balancing Across Replicas:<a class="headerlink" href="#load-balancing-across-replicas" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Client Discovery Result:
├─ Stage 0 (front): [front.0.0.0, front.0.1.0]
└─ Stage 1 (back):  [back.0.0.0, back.0.1.0]

Complete Pipelines (all possible paths):
1. front.0.0.0 → back.0.0.0  (Trainer 1)
2. front.0.0.0 → back.0.1.0  (Trainer 2)
3. front.0.1.0 → back.0.0.0  (Trainer 3)
4. front.0.1.0 → back.0.1.0  (Trainer 4)

Client spawns 4 trainers, one for each path
Each trainer uses a unique pipeline to maximize throughput
</pre></div>
</div>
</section>
</section>
<section id="scaling-patterns">
<h2>Scaling Patterns:<a class="headerlink" href="#scaling-patterns" title="Link to this heading">¶</a></h2>
<section id="horizontal-scaling-add-more-replicas">
<h3>Horizontal Scaling (Add More Replicas):<a class="headerlink" href="#horizontal-scaling-add-more-replicas" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Initial: 1 replica per stage
├─ front.0.0.0 → back.0.0.0 (1 trainer)

Add Workers:
├─ front.0.0.0 → back.0.0.0 (2 trainers)
└─ front.0.1.0 → back.0.1.0 

Add Workers:
├─ front.0.0.0 → back.0.0.0 (3 trainers)
├─ front.0.1.0 → back.0.1.0
└─ front.0.2.0 → back.0.2.0
</pre></div>
</div>
</section>
<section id="vertical-scaling-add-more-stages">
<h3>Vertical Scaling (Add More Stages):<a class="headerlink" href="#vertical-scaling-add-more-stages" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2-Stage Pipeline:
Input → front.0.X.0 → back.0.X.0 → Output

3-Stage Pipeline:
Input → head.0.X.0 → body.0.X.0 → tail.0.X.0 → Output

4-Stage Pipeline:
Input → head.0.X.0 → body1.0.X.0 → body2.0.X.0 → tail.0.X.0 → Output
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DistQat</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DOCUMENTATION_INDEX.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../QUICK_START.html">Quick Start Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deployment Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEPLOYMENT.html">Setup/Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SKYPILOT_SERVER_SETUP.html">Skypilot server setup template</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture Diagrams</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ARCHITECTURE.html">Architecture Diagram</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Node Arrangement Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRAINING_FLOW.html">Training Flow Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAILOVER.html">Failover Mechanism Diagram</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ARCHITECTURE.html" title="previous chapter">Architecture Diagram</a></li>
      <li>Next: <a href="TRAINING_FLOW.html" title="next chapter">Training Flow Diagram</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, SEMRON Team.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/diagrams/NODE_ARRANGEMENT.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>